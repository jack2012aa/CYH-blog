<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=en-us dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>[SyntaxNext] How to Combine React and Traditional TypeScript - CYH Blog</title>
<meta name=theme-color><meta name=description content="Initial Design
At the beginning, we used a pure HTML, CSS, and TypeScript architecture. This was a logical decision, as less than 40% of the extension&rsquo;s code is UI-related, and none of us were familiar with frontend frameworks. This approach also avoided the added complexity of state management libraries.
In this design, the file running as the content script (which we called content) imports other files to perform its tasks, including the UI component (which we called interviewTab). interviewTab exports functions that change the UI&rsquo;s appearance, and the state is managed in content. This worked well when the UI was simple and indeed shortened development time."><meta name=author content="Chang-Yu Huang"><link rel="preload stylesheet" as=style href=https://jack2012aa.github.io/CYH-blog/main.min.css><link rel=preload as=image href=https://jack2012aa.github.io/CYH-blog/theme.png><link rel=preload as=image href=img/oct.JPG><link rel=preload as=image href=https://jack2012aa.github.io/CYH-blog/github.svg><script defer src=https://jack2012aa.github.io/CYH-blog/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jack2012aa.github.io/CYH-blog/img/cloud.JPG><link rel=apple-touch-icon href=https://jack2012aa.github.io/CYH-blog/apple-touch-icon.png><meta name=generator content="Hugo 0.139.3"><meta itemprop=name content="[SyntaxNext] How to Combine React and Traditional TypeScript"><meta itemprop=description content="Initial Design At the beginning, we used a pure HTML, CSS, and TypeScript architecture. This was a logical decision, as less than 40% of the extension’s code is UI-related, and none of us were familiar with frontend frameworks. This approach also avoided the added complexity of state management libraries.
In this design, the file running as the content script (which we called content) imports other files to perform its tasks, including the UI component (which we called interviewTab). interviewTab exports functions that change the UI’s appearance, and the state is managed in content. This worked well when the UI was simple and indeed shortened development time."><meta itemprop=datePublished content="2025-07-07T18:35:31+08:00"><meta itemprop=dateModified content="2025-07-07T18:35:31+08:00"><meta itemprop=wordCount content="520"><meta itemprop=keywords content="Chrome Extension,TypeScript,React,Zustand"><meta property="og:url" content="https://jack2012aa.github.io/CYH-blog/posts/syntaxnext/2-react/"><meta property="og:site_name" content="CYH Blog"><meta property="og:title" content="[SyntaxNext] How to Combine React and Traditional TypeScript"><meta property="og:description" content="Initial Design At the beginning, we used a pure HTML, CSS, and TypeScript architecture. This was a logical decision, as less than 40% of the extension’s code is UI-related, and none of us were familiar with frontend frameworks. This approach also avoided the added complexity of state management libraries.
In this design, the file running as the content script (which we called content) imports other files to perform its tasks, including the UI component (which we called interviewTab). interviewTab exports functions that change the UI’s appearance, and the state is managed in content. This worked well when the UI was simple and indeed shortened development time."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-07T18:35:31+08:00"><meta property="article:modified_time" content="2025-07-07T18:35:31+08:00"><meta property="article:tag" content="Chrome Extension"><meta property="article:tag" content="TypeScript"><meta property="article:tag" content="React"><meta property="article:tag" content="Zustand"><meta name=twitter:card content="summary"><meta name=twitter:title content="[SyntaxNext] How to Combine React and Traditional TypeScript"><meta name=twitter:description content="Initial Design At the beginning, we used a pure HTML, CSS, and TypeScript architecture. This was a logical decision, as less than 40% of the extension’s code is UI-related, and none of us were familiar with frontend frameworks. This approach also avoided the added complexity of state management libraries.
In this design, the file running as the content script (which we called content) imports other files to perform its tasks, including the UI component (which we called interviewTab). interviewTab exports functions that change the UI’s appearance, and the state is managed in content. This worked well when the UI was simple and indeed shortened development time."><link rel=canonical href=https://jack2012aa.github.io/CYH-blog/posts/syntaxnext/2-react/></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-[--w] px-8 lg:justify-center"><div class="relative z-50 ltr:mr-auto rtl:ml-auto flex items-center"><a class="-translate-y-[1px] text-2xl font-medium" href=https://jack2012aa.github.io/CYH-blog/>CYH Blog</a><div class="btn-dark text-[0] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 ltr:-mr-8 rtl:-ml-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/CYH-blog/about/>About</a>
<a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/CYH-blog/categories/courseworks/>Courseworks</a>
<a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/CYH-blog/categories/sideprojects/>Side Projects</a></nav><nav class="mt-12 flex justify-center space-x-10 rtl:space-x-reverse dark:invert ltr:lg:ml-14 rtl:lg:mr-14 lg:mt-0 lg:items-center"><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/jack2012aa target=_blank rel=me>github</a></nav></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100vh-9rem)] max-w-[--w] px-8 pb-16 pt-14 dark:prose-invert"><article><header class=mb-14><h1 class="!my-0 pb-2.5">[SyntaxNext] How to Combine React and Traditional TypeScript</h1><div class="text-xs antialiased opacity-60"><time>Jul 7, 2025</time></div></header><section><h1 id=initial-design>Initial Design</h1><p>At the beginning, we used a pure HTML, CSS, and TypeScript architecture. This was a logical decision, as less than 40% of the extension&rsquo;s code is UI-related, and none of us were familiar with frontend frameworks. This approach also avoided the added complexity of state management libraries.</p><p>In this design, the file running as the content script (which we called <code>content</code>) imports other files to perform its tasks, including the UI component (which we called <code>interviewTab</code>). <code>interviewTab</code> exports functions that change the UI&rsquo;s appearance, and the state is managed in <code>content</code>. This worked well when the UI was simple and indeed shortened development time.</p><p>With more and more updates and UI requirements, we found that we were spending too much time writing new components. New components introduced new states. However, many of them were related and should have been controlled by the same variable.</p><h1 id=new-design>New Design</h1><p>The biggest challenge came from the separated frontend-backend communication. Normally, the state belongs to a component and cannot be modified externally. This conflicted with the separate WebSocket, which is outside of the React environment.</p><p><code>zustand</code> is a good library to use in this situation. It creates a <code>Store</code> that contains the state and actions that change the state. Using the <code>Store</code>, we can easily know what state we have and therefore use the existing state to control the UI.</p><p>For example, we have an <code>interviewState</code> that indicates whether the interview is preparing, started, evaluating, or stopped. Initially, the interview is stopped. Pressing the start button changes the state to &lsquo;preparing&rsquo; and sends a WebSocket message to the agent. The last step requires a <code>window.postMessage</code> to contact the WebSocket iframe. Once it receives the response message, the WebSocket event listener must change the state to &lsquo;started&rsquo;. Since it is in an iframe, it has to use another <code>postMessage</code> to tell <code>content</code> what to do.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-TypeScript data-lang=TypeScript><span style=display:flex><span><span style=color:#75715e>// WebSocket iframe
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;message&#39;</span>, (<span style=color:#a6e22e>event</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;start interview&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>websocket</span>.<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;start interview&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>websocket</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;message&#39;</span>, (<span style=color:#a6e22e>event</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;start interview response&#39;</span>) {
</span></span><span style=display:flex><span>        window.<span style=color:#a6e22e>postMessage</span>({<span style=color:#e6db74>&#39;start interview response&#39;</span>}, <span style=color:#f92672>*</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// content.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;message&#39;</span>, (<span style=color:#a6e22e>event</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;start interview response&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Change the interview state to started
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// store.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>store</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>create</span>&lt;<span style=color:#f92672>StoreInterface</span>&gt;(...)
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>changeInterviewState</span>(<span style=color:#a6e22e>state</span>: <span style=color:#66d9ef>InterviewState</span>) {...}
</span></span></code></pre></div><p><code>content</code> lives in the same environment as React, which means it can acquire the <code>Store</code> and modify the state directly. But adding a layer of abstraction is always better; we don&rsquo;t have to modify <code>content</code> if the React part is changed in the future.</p><h1 id=place-for-improvement>Place for Improvement</h1><p>Honestly speaking, this complexity comes from the decision to use WebSockets. As I said in the previous article, using RESTful APIs may be a better choice, both from the point of view of frontend complexity and backend scalability.</p><p><code>zustand</code> is not the solution for every issue. For instance, <code>useEffect</code> may be used inside React components. Collecting every state-changing statement in a file is nearly impossible. The best way is to write some documentation and force everyone to read it before they start development.</p><h1 id=next>Next</h1><p>I will talk about real-time speech-to-text in the next article.</p></section><footer class="mt-12 flex flex-wrap"><a class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://jack2012aa.github.io/CYH-blog/tags/chrome-extension>Chrome Extension</a>
<a class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://jack2012aa.github.io/CYH-blog/tags/typescript>TypeScript</a>
<a class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://jack2012aa.github.io/CYH-blog/tags/react>React</a>
<a class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://jack2012aa.github.io/CYH-blog/tags/zustand>zustand</a></footer><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg !leading-[1.2] *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:ml-auto rtl:mr-auto justify-end pl-3" href=https://jack2012aa.github.io/CYH-blog/posts/syntaxnext/1-intro/><span>[SyntaxNext] Project Introduction</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a></nav></article></main><footer class="mx-auto flex h-[4.5rem] max-w-[--w] items-center px-8 text-xs uppercase tracking-wider opacity-60"><div class=mr-auto>&copy; 2025
<a class=link href=https://jack2012aa.github.io/CYH-blog/>CYH Blog</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a></footer></body></html>